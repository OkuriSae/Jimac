<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>歌枠字幕ジェネレータ</title>

  <!-- Vue -->
  <script src="https://unpkg.com/vue@next"></script>

  <!-- JQuery -->
  <script
    src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
    crossorigin="anonymous"></script>

  <!-- font Awesome -->
  <script src="https://kit.fontawesome.com/55dea25b7a.js" crossorigin="anonymous"></script>

  <!-- Bulma -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-extensions@4.0.0/dist/css/bulma-extensions.min.css">
  <script src="https://cdn.jsdelivr.net/npm/bulma-extensions@4.0.0/dist/js/bulma-extensions.min.js"></script>

  <!-- Clipboard -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.8/clipboard.min.js"></script>
  
  <link rel="stylesheet" href="style.css">

</head>

<body>
  <section>
    <div class="container">
      <h1 class="title">歌枠字幕ジェネレーター</h1>
      <div class="columns is-mobile">

        <!-- Repertory -->
        <div id="repertory" class="column sidebar">
          <div class="repertory">
            <div v-for="song in repertory" class="button" style="width: 100%; margin-bottom: 5px;" @click="select(song.id)">{{ song.title }}</div>
            <div class="button" style="width: 100%; margin-bottom: 5px;" @click="addSong">新規追加＋</div>

          </div>
        </div>
        
        <div id="jimakuGenerator" class="column content">
          <div style="width:100%;">

            <button id="jimaku" class="button jimaku-area" :data-clipboard-text="jimaku">

              <!-- Jimaku text CSS -->
              <component is="style">
                .jimaku-area {
                  background-color: {{ jimakuBackColor }};
                }
                .jimaku{
                  font-size: {{ jimakuFontSize }};
                  font-family: {{ jimakuFontFamily }};
                }
                .jimaku-0,.jimaku-2{
                  color: {{ jimakuTextColor }};
                }
              </component>
              
              <!-- Jimaku anim CSS (Toggle) -->
              <component v-if="jimakuAnim !== 'none'" is="style">
                @keyframes text-in {
                  0% {
                    transform: translate(0, -20px);
                    opacity: 0;
                  }
                }
                .item {
                  display: inline-block;
                  animation: text-in .8s cubic-bezier(0.22, 0.15, 0.25, 1.43) 0s backwards;
                }
              </component>
              
              <div v-show="jimakuOutline" id="jimaku-0"><span v-for="(t, i) in jimaku" :key="i" class="item jimaku" :style="{animationDelay: (i*100)*(jimakuAnim==='fall'?0:1)+'ms'}">{{ t === ' ' ? '\xa0' : t }}</span></div>
              <div v-show="jimakuOutline" id="jimaku-1"><span v-for="(t, i) in jimaku" :key="i" class="item jimaku" :style="{animationDelay: (i*100)*(jimakuAnim==='fall'?0:1)+'ms'}">{{ t === ' ' ? '\xa0' : t }}</span></div>
              <div id="jimaku-2"><span v-for="(t, i) in jimaku" :key="i" class="item jimaku" :style="{animationDelay: (i*100)*(jimakuAnim==='fall'?0:1)+'ms'}">{{ t === ' ' ? '\xa0' : t }}</span></div>
            </button>

            <div id="controller">

              <!-- JimakuIndex -->
              <div class="button" @click="setJimakuIndex(0)"><i class="fas fa-angle-double-left"></i></div>
              <div class="button" @click="setJimakuIndex(this.jimakuIndex-1)"><i class="fas fa-angle-left"></i></div>
              <div class="button" style="width:44px; background-color: rgb(255,255,255,0.5);">{{jimakuIndex}}</div>
              <div class="button" @click="setJimakuIndex(this.jimakuIndex+1)"><i class="fas fa-angle-right"></i></div>

              <!-- BackColor -->
              <div class="button jimakuCtrl">Back:</div>
              <input class="input" style="width:44px;" type="color" v-model="jimakuBackColor" placeholder="#BackColor">
              
              <!-- TextColor -->
              <div class="button jimakuCtrl">Text:</div>
              <input class="input" style="width:44px;" type="color" v-model="jimakuTextColor" placeholder="#TextColor">
              
              <!-- FontFamily -->
              <div class="button jimakuCtrl">Font:</div>
              <div class="select">
                <select name="fontFamily" style="width:170px;" v-model="jimakuFontFamily">
                  <option value="'Kiwi Maru', serif">Kiwi Maru</option>
                  <option value="'Yusei Magic', sans-serif">Yusei Magic</option>
                  <option value="'Hachi Maru Pop', cursive">Hachi Maru Pop</option>
                  <option value="'Kaisei Tokumin', serif">Kaisei Tokumin</option>
                  <option value="'DotGothic16', sans-serif">DotGothic16</option>
                </select>
              </div>

              <!-- FontSize -->
              <div class="button jimakuCtrl">Size:</div>
              <input class="input" style="width:60px;" type="text" v-model="jimakuFontSize">

              <!-- Animation -->
              <div class="button jimakuCtrl">Anim:</div>
              <div class="select">
                <select style="width:92px;" v-model="jimakuAnim">
                  <option value="none">none</option>
                  <option value="fall">fall</option>
                  <option value="Stairs">Stairs</option>
                </select>
              </div>

              <!-- Outline -->
              <div class="field" style="display: inline;">
                <input id="outlineSw" v-model="jimakuOutline" type="checkbox" name="outlineSw" class="switch is-rtl">
                <label for="outlineSw" style="padding-left: 15px; padding-right: 53px; top: 8px;">Outline:</label>
              </div>
              
            </div>

            <!-- lyricEditor -->
            <input class="input" type="hidden" v-model="songId">
            <div class="paper">
              <div class="paper-content">
                  <textarea 
                    id="lyric"
                    autofocus
                    contenteditable 
                    v-model="lyric" 
                    @input="changelyric"
                    @focus="updateJimakuIndex"
                    @click="updateJimakuIndex"
                    @keyup="moveEditorCousor"
                    placeholder=
"曲名 / アーティスト

ここに歌詞を貼り付けます"></textarea>
              </div>
            </div>
            <div>
              <div style="text-align: right;">
                <div class="button is-small is-danger is-inverted" @click="deleteSong"><i class="fas fa-trash-alt"> Delete</i></div>
              </div>
            </div>
            
          </div>
        </div>
      </div>
    </div>
  </section>


  <script src="script.js"></script>
</body>
</html>